<!--
  Generated template for the Car page.

  See http://ionicframework.com/docs/v2/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

    <ion-navbar>
        <ion-title>购物车</ion-title>
        <ion-buttons right>
            <button ion-button clear *ngIf="carDetails&&carDetails?.suppliers_goods_list?.length!=0" (click)="isEdit=!isEdit">{{isEdit?'取消':'编辑'}}</button>
        </ion-buttons>
    </ion-navbar>

</ion-header>


<ion-content>
    <ion-refresher (ionRefresh)="doRefresh($event)" pullMax="60">
        <ion-refresher-content refreshingSpinner="1" pullingIcon="0"></ion-refresher-content>
    </ion-refresher>
    <nothing backgroundImg="url(./assets/images/images/no-car_1_03.png)" *ngIf="carDetails?.suppliers_goods_list.length==0"></nothing>
    <ion-list>
        <div class="single-shop" *ngFor="let item of carDetails?.suppliers_goods_list">
            <div class="single-shop-head">
                <ion-checkbox [(ngModel)]="item.selected" [checked]="carDetails?.selected" mode="ios" margin-left></ion-checkbox>
                <ion-item mode="ios" no-lines margin-left>
                    <ion-icon color="colorsix" item-left name="shop"></ion-icon>
                    {{item.title}}&nbsp;
                    <ion-icon color="colorsix" name="ios-arrow-forward"></ion-icon>
                    <button item-right ion-button clear color="danger">优惠券???</button>
                </ion-item>
            </div>
            <div class="single-shop-goods" *ngFor="let item2 of item.goods_list ">
                <div class="single-shop-goods-head">
                    <div margin-left>
                        <ion-checkbox [(ngModel)]="item2.selected" (ionChange)="checkGoods(item2)" [checked]="item.selected==true" color="dark" mode="ios"></ion-checkbox>
                    </div>
                    <ion-item margin-left no-lines>
                        <ion-thumbnail item-left>
                            <img src="{{item2.goods_thumb}}">
                        </ion-thumbnail>
                        <h2 (click)="goParticularPage(item2.goods_id)">{{item2.goods_name}}</h2>
                        <span class="type">促销???</span>
                    </ion-item>
                </div>
                <div class="single-shop-goods-body">
                    <div class="item-wrap" *ngFor="let item3 of item2.attrs;">
                        <div margin-left>
                            <ion-checkbox [(ngModel)]="item3.selected" [checked]="item2.selected" color="dark" mode="ios"></ion-checkbox>
                        </div>
                        <div margin-left class="sliding-item-box">
                            <ion-item-sliding>
                                <ion-item no-lines>
                                    <div class="goodsinfo">
                                        <div class="attr">
                                            <span *ngIf="item3.qiujing">球镜：{{item3.qiujing}}</span>
                                            <span *ngIf="item3.zhujing">柱镜：{{item3.zhujing}}</span>
                                            <span *ngIf="item3.zhouwei">轴位：{{item3.zhouwei}}</span>
                                            <span *ngFor="let item4 of item3?.arr_attr;">{{item4}}</span>
                                        </div>
                                        <div class="bottom">
                                            <div class="price">¥{{item3?.goods_price}}</div>
                                            <div class="number">
                                                <count-input (updateNumberI)="numberChangeI($event,item3)" [lock]="item3.inputLock" [value]="item3?.goods_number"></count-input>
                                            </div>
                                        </div>
                                    </div>
                                </ion-item>
                                <ion-item-options side="right">
                                    <button ion-button color="danger" (click)="deleteItem(item3)">删除</button>
                                </ion-item-options>
                            </ion-item-sliding>
                        </div>
                    </div>
                </div>
            </div>
            <div class="single-shop-little-result">小计: <span class="red">¥{{item?.goods_price_total}}</span>&nbsp;&nbsp;共{{item?.goods_count}}件</div>
            <div class="background"></div>
        </div>
    </ion-list>
</ion-content>
<ion-footer>
    <div class="car-accounts" *ngIf="carDetails&&carDetails?.suppliers_goods_list?.length!=0">
        <div class="left">
            <div class="select-all" margin-horizontal>
                <ion-checkbox [(ngModel)]="carDetails.selected" margin-right color="dark" mode="ios"></ion-checkbox>
                全选
            </div>
            <div *ngIf="!isEdit" class="price">合计：¥{{carDetails?.total?.goods_amount}}</div>
        </div>
        <div *ngIf="!isEdit" class="right" (click)="goAccounts()">去结算({{carDetails?.total?.real_goods_count}})</div>
        <div *ngIf="isEdit" class="attention-and-delete">
            <button ion-button outline color="dark" (click)="beCareFor()">移入关注</button>
            <button ion-button color="dark" (click)="dropCartGoodsSelect()">　删除　</button>
        </div>
    </div>
</ion-footer>