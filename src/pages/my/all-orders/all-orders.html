<!--
  Generated template for the AllOrders page.

  See http://ionicframework.com/docs/v2/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header no-border>

    <ion-navbar>
        <ion-title>所有订单</ion-title>
    </ion-navbar>
    <ion-toolbar no-padding>
        <img-tabs #mytabs (slideClick)="checkTab($event)"></img-tabs>
    </ion-toolbar>
</ion-header>

<ion-content #myContent>
    <div class="background"></div>
    <div class="no-log" *ngIf="orderData&&!orderData?.list?.length">
        <div class="img">
            <img src="./assets/icon/no-log.png" alt="">
        </div>
        <div class="message">您还没有相关订单</div>
    </div>
    <div class="single-shop" *ngFor="let item of orderData?.list;">
        <ion-item-divider>
            <ion-icon *ngIf="item.suppliers_name" item-left name="shop"></ion-icon>
            <div class="shop-title" tappable (click)="goParticularsHomePage(item.suppliers_id)">
                {{item.suppliers_name}}&nbsp;
                <ion-icon *ngIf="item.suppliers_name" name="ios-arrow-forward"></ion-icon>
            </div>
            <button item-right ion-button clear color="danger" icon-right>
                {{item.status}}
                <!-- <ion-icon name="ios-trash-outline"></ion-icon> -->
            </button>
        </ion-item-divider>
        <ion-item no-lines tappable (click)="goOrdersDetailPage(item.order_id)" *ngIf="item.goods.length<2">
            <ion-thumbnail item-left>
                <img [img-lazy-load]="item.goods[0]?.original_img">
            </ion-thumbnail>
            <div class="my-content">
                <div class="left">
                    <h2>{{item.goods[0].goods_name}}</h2>
                    <div [innerHtml]="item.goods[0].goods_attr"></div>
                </div>
                <div class="right">
                    <div>{{item.goods[0].format_amount}}</div>
                    <div class="count">X{{item.goods[0].goods_number}}</div>
                </div>
            </div>
        </ion-item>
        <ion-item style="overflow-x:scroll" no-lines tappable (click)="goOrdersDetailPage(item.order_id)" *ngIf="item.goods.length>2">
            <!--  (click)="$event.stopPropagation();goParticularsPage(goods.goods_id);"  -->
            <ion-thumbnail item-left *ngFor="let goods of item.goods">
                <img [img-lazy-load]="goods.original_img">
            </ion-thumbnail>
        </ion-item>
        <div class="result">
            <span class="count">共{{item.goods_number}}件商品</span>&nbsp;&nbsp;<span class="price">合计: <span>￥{{item.total_fee}}</span></span>
        </div>
        <div class="btn" *ngIf="(item.order_status == 0)||((item.order_status==5 && item.shipping_status==2)||item.order_status==2||item.order_status==3)||((item.order_status==5 && item.pay_status==2 && item.shipping_status==2)||(item.order_status==2 && item.pay_status==0 && item.shipping_status==0))||(item.pay_status == 0 && item.order_status!=4 && item.order_status!=2 && item.order_status!=3 && item.order_status!=7 && item.order_status!=8)||(item.order_status == '5' && item.shipping_status=='1')">

            <button ion-button outline color="jingku1" (click)="cancelOrder(item.order_id)" *ngIf="item.order_status == 0">取消订单</button>
            <button ion-button outline color="jingku1" (click)="deleteOrder(item.order_id)" *ngIf="(item.order_status==5 && item.shipping_status==2)||item.order_status==2||item.order_status==3">删除订单</button>
            <!-- <button ion-button outline navPush="OrderWuliuPage" [navParams]="{orderId:item.order_id}" *ngIf="(item.order_status==1&&item.pay_status==2)||(item.order_status==5&&item.pay_status==2&&item.shipping_status==1)||(item.order_status==5&&item.pay_status==2&&item.shipping_status==2)">物流跟踪</button> -->
            <button ion-button color="jingku1" (click)="goOrdersDetailPage(item.order_id)" *ngIf="(item.order_status==5 && item.pay_status==2 && item.shipping_status==2)||(item.order_status==2 && item.pay_status==0 && item.shipping_status==0)">再次购买</button>
            <button ion-button color="jingku1" (click)="toPay(item.order_id)" *ngIf="item.pay_status == 0 && item.order_status!=4 && item.order_status!=2 && item.order_status!=3 && item.order_status!=7 && item.order_status!=8 ">去支付</button>
            <button ion-button color="jingku1" (click)="confirmReceipt(item.order_id)" *ngIf="item.order_status == '5' && item.shipping_status=='1'">确认收货</button>

        </div>
    </div>

    <ion-fab right bottom (click)="myContent.scrollToTop()">
        <button ion-fab color="jingku1" mini goBackTop></button>
    </ion-fab>
    <ion-infinite-scroll (ionInfinite)="doInfinite($event)" *ngIf="flag">
        <ion-infinite-scroll-content></ion-infinite-scroll-content>
    </ion-infinite-scroll>
</ion-content>